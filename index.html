<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Professional news article editor inspired by NYT, Washington Post, and Guardian publishing systems" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="color-scheme" content="light" />

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="News Article Editor" />
    <meta property="og:description" content="Professional news article editor inspired by NYT, Washington Post, and Guardian publishing systems" />
    <meta name="twitter:card" content="summary" />

    <title>News Article Editor</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“°</text></svg>" />

    <!-- Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Lucide React Icons from CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

    <style>
      #root:empty {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #f9fafb;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }
      #root:empty::after {
        content: 'Loading editor...';
        color: #6b7280;
        font-size: 1rem;
      }
      .prose p { margin: 1.2em 0; }
      .prose h1, .prose h2, .prose h3 { margin-top: 1.5em; margin-bottom: 0.5em; font-weight: bold; }
      .prose h1 { font-size: 2em; }
      .prose h2 { font-size: 1.5em; }
      .prose h3 { font-size: 1.25em; }
      .prose blockquote { border-left: 4px solid #3b82f6; padding-left: 1em; margin: 1em 0; font-style: italic; color: #4b5563; }
      .prose ul, .prose ol { margin: 1em 0; padding-left: 2em; }
      .prose li { margin: 0.25em 0; }
      .prose a { color: #3b82f6; text-decoration: underline; }
      .prose code { background: #f3f4f6; padding: 0.2em 0.4em; border-radius: 3px; font-family: monospace; }
      .prose img { max-width: 100%; height: auto; margin: 1.5em 0; border-radius: 4px; }
      .prose figure { margin: 2em 0; }
      .prose figcaption { color: #6b7280; font-size: 0.875rem; margin-top: 0.5em; font-style: italic; text-align: center; }

      /* Image styles */
      .article-image { position: relative; margin: 1.5em 0; }
      .article-image.full-width { width: 100%; }
      .article-image.medium { width: 75%; margin-left: auto; margin-right: auto; }
      .article-image.small { width: 50%; }
      .article-image.float-left { float: left; width: 40%; margin-right: 1.5em; margin-bottom: 1em; }
      .article-image.float-right { float: right; width: 40%; margin-left: 1.5em; margin-bottom: 1em; }
      .article-image img { width: 100%; height: auto; display: block; }

      /* Homepage styles */
      .article-card { transition: transform 0.2s, box-shadow 0.2s; }
      .article-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); }
      .category-label { font-size: 0.7rem; letter-spacing: 0.1em; text-transform: uppercase; }

      /* Modal styles */
      .modal-backdrop { background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <noscript>
      <div style="display: flex; justify-content: center; align-items: center; min-height: 100vh; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; text-align: center; padding: 20px;">
        <div>
          <h1 style="color: #1f2937; margin-bottom: 16px;">JavaScript Required</h1>
          <p style="color: #6b7280;">Please enable JavaScript to use the News Article Editor.</p>
        </div>
      </div>
    </noscript>
    <script>
      // Icon helper - creates SVG icons using Lucide
      const createIcon = (name, size = 18) => {
        const icon = lucide.icons[name];
        if (!icon) return null;
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('width', size);
        svg.setAttribute('height', size);
        svg.setAttribute('viewBox', '0 0 24 24');
        svg.setAttribute('fill', 'none');
        svg.setAttribute('stroke', 'currentColor');
        svg.setAttribute('stroke-width', '2');
        svg.setAttribute('stroke-linecap', 'round');
        svg.setAttribute('stroke-linejoin', 'round');
        const children = icon[2];
        if (Array.isArray(children)) {
          children.forEach(child => {
            if (Array.isArray(child) && child.length >= 2) {
              const [tagName, attrs] = child;
              const el = document.createElementNS('http://www.w3.org/2000/svg', tagName);
              Object.entries(attrs || {}).forEach(([key, value]) => {
                el.setAttribute(key, value);
              });
              svg.appendChild(el);
            }
          });
        }
        return svg;
      };

      const Icon = ({ name, size = 18 }) => {
        const ref = React.useRef(null);
        React.useEffect(() => {
          if (ref.current) {
            ref.current.innerHTML = '';
            const svg = createIcon(name, size);
            if (svg) ref.current.appendChild(svg);
          }
        }, [name, size]);
        return React.createElement('span', { ref, style: { display: 'inline-flex', alignItems: 'center' } });
      };

      const { useState, useRef, useEffect } = React;

      // Sample articles for homepage demo
      const sampleArticles = [
        {
          id: 1,
          title: 'Colleges Are Preparing to Self-Lobotomize',
          subtitle: 'The skills that students will need in an age of automation are precisely those that are eroded by inserting AI into the educational process.',
          byline: 'Michael Clune',
          category: 'Ideas',
          date: 'November 29, 2025',
          image: 'https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800&q=80',
          imageCredit: 'Illustration by The Atlantic',
          featured: true,
          body: '<p>After three years of doing essentially nothing to address the rise of generative AI, colleges are now scrambling to do too much...</p>'
        },
        {
          id: 2,
          title: 'The Comedian Dismantling the Alpha-Male Persona',
          subtitle: 'A fresh take on masculinity in modern comedy.',
          byline: 'Shirley Li',
          category: 'Culture',
          date: 'November 29, 2025',
          image: 'https://images.unsplash.com/photo-1585699324551-f6c309eedeca?w=600&q=80',
          imageCredit: 'HBO',
          body: '<p>Comedy is evolving...</p>'
        },
        {
          id: 3,
          title: 'Get Your Kid a Watch',
          subtitle: 'Teaching time management starts with analog.',
          byline: 'Ian Bogost',
          category: 'Family',
          date: 'November 29, 2025',
          image: 'https://images.unsplash.com/photo-1524805444758-089113d48a6d?w=600&q=80',
          imageCredit: 'Illustration by Kyle Smart',
          body: '<p>In an age of smartphones...</p>'
        },
        {
          id: 4,
          title: 'The Limits of the Year\'s Most Heartbreaking Film',
          subtitle: 'Hamnet imagines the inspiration for Hamlet as a tragic, punishing love story.',
          byline: 'David Sims',
          category: 'Movies',
          date: 'November 28, 2025',
          image: 'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?w=600&q=80',
          imageCredit: 'Focus Features',
          body: '<p>The new film explores...</p>'
        },
        {
          id: 5,
          title: 'Black Friday Nostalgia',
          subtitle: 'If we\'re going to worship consumerism and consumption, let\'s at least do it together.',
          byline: 'Annie Joy Williams',
          category: 'Opinion',
          date: 'November 28, 2025',
          image: 'https://images.unsplash.com/photo-1607083206869-4c7672e72a8a?w=600&q=80',
          imageCredit: 'Getty',
          body: '<p>The tradition continues...</p>'
        },
        {
          id: 6,
          title: 'How to Change Your Sleep Patterns',
          subtitle: 'A guide to better rest.',
          byline: 'Isabel Fattal',
          category: 'Health',
          date: 'November 28, 2025',
          image: 'https://images.unsplash.com/photo-1541781774459-bb2af2f05b55?w=600&q=80',
          body: '<p>Sleep experts recommend...</p>'
        }
      ];

      // Image Modal Component
      const ImageModal = ({ isOpen, onClose, onInsert }) => {
        const [imageUrl, setImageUrl] = useState('');
        const [caption, setCaption] = useState('');
        const [credit, setCredit] = useState('');
        const [size, setSize] = useState('full-width');
        const [alignment, setAlignment] = useState('center');
        const [previewError, setPreviewError] = useState(false);

        const handleInsert = () => {
          if (!imageUrl) return;
          onInsert({ url: imageUrl, caption, credit, size, alignment });
          setImageUrl('');
          setCaption('');
          setCredit('');
          setSize('full-width');
          setAlignment('center');
          onClose();
        };

        if (!isOpen) return null;

        return React.createElement('div', {
          className: 'fixed inset-0 z-50 flex items-center justify-center modal-backdrop',
          onClick: (e) => e.target === e.currentTarget && onClose()
        },
          React.createElement('div', { className: 'bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 overflow-hidden' },
            // Header
            React.createElement('div', { className: 'flex items-center justify-between px-6 py-4 border-b border-gray-200' },
              React.createElement('h2', { className: 'text-lg font-semibold text-gray-900' }, 'Insert Image'),
              React.createElement('button', {
                onClick: onClose,
                className: 'p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100'
              }, React.createElement(Icon, { name: 'x', size: 20 }))
            ),
            // Body
            React.createElement('div', { className: 'p-6 space-y-4' },
              // Image URL
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Image URL'),
                React.createElement('input', {
                  type: 'url',
                  value: imageUrl,
                  onChange: (e) => { setImageUrl(e.target.value); setPreviewError(false); },
                  placeholder: 'https://example.com/image.jpg',
                  className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                })
              ),
              // Preview
              imageUrl && React.createElement('div', { className: 'border border-gray-200 rounded-lg p-4 bg-gray-50' },
                React.createElement('p', { className: 'text-xs text-gray-500 mb-2' }, 'Preview'),
                previewError
                  ? React.createElement('div', { className: 'text-center py-8 text-gray-400' },
                      React.createElement(Icon, { name: 'image-off', size: 32 }),
                      React.createElement('p', { className: 'mt-2 text-sm' }, 'Unable to load image')
                    )
                  : React.createElement('img', {
                      src: imageUrl,
                      alt: 'Preview',
                      className: 'max-h-48 mx-auto rounded',
                      onError: () => setPreviewError(true)
                    })
              ),
              // Caption
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Caption (optional)'),
                React.createElement('input', {
                  type: 'text',
                  value: caption,
                  onChange: (e) => setCaption(e.target.value),
                  placeholder: 'Describe this image...',
                  className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                })
              ),
              // Credit
              React.createElement('div', null,
                React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Photo Credit (optional)'),
                React.createElement('input', {
                  type: 'text',
                  value: credit,
                  onChange: (e) => setCredit(e.target.value),
                  placeholder: 'Photo by...',
                  className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                })
              ),
              // Size and Alignment
              React.createElement('div', { className: 'grid grid-cols-2 gap-4' },
                React.createElement('div', null,
                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Size'),
                  React.createElement('select', {
                    value: size,
                    onChange: (e) => setSize(e.target.value),
                    className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500'
                  },
                    React.createElement('option', { value: 'full-width' }, 'Full Width'),
                    React.createElement('option', { value: 'medium' }, 'Medium (75%)'),
                    React.createElement('option', { value: 'small' }, 'Small (50%)'),
                    React.createElement('option', { value: 'float-left' }, 'Float Left'),
                    React.createElement('option', { value: 'float-right' }, 'Float Right')
                  )
                ),
                React.createElement('div', null,
                  React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-1' }, 'Alignment'),
                  React.createElement('select', {
                    value: alignment,
                    onChange: (e) => setAlignment(e.target.value),
                    className: 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500'
                  },
                    React.createElement('option', { value: 'center' }, 'Center'),
                    React.createElement('option', { value: 'left' }, 'Left'),
                    React.createElement('option', { value: 'right' }, 'Right')
                  )
                )
              )
            ),
            // Footer
            React.createElement('div', { className: 'flex justify-end gap-3 px-6 py-4 bg-gray-50 border-t border-gray-200' },
              React.createElement('button', {
                onClick: onClose,
                className: 'px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors'
              }, 'Cancel'),
              React.createElement('button', {
                onClick: handleInsert,
                disabled: !imageUrl,
                className: 'px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2'
              }, React.createElement(Icon, { name: 'image', size: 16 }), 'Insert Image')
            )
          )
        );
      };

      // Article Card Component
      const ArticleCard = ({ article, size = 'medium', onClick }) => {
        const sizeClasses = {
          small: 'col-span-1',
          medium: 'col-span-1',
          large: 'col-span-2 row-span-2',
          featured: 'col-span-2'
        };

        if (size === 'list') {
          return React.createElement('div', {
            className: 'flex gap-4 py-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 px-2 -mx-2 rounded',
            onClick
          },
            React.createElement('div', { className: 'flex-1' },
              React.createElement('h4', { className: 'font-semibold text-gray-900 text-sm leading-tight mb-1 hover:text-blue-600' }, article.title),
              React.createElement('p', { className: 'text-xs text-gray-500 uppercase tracking-wide' }, article.byline)
            ),
            article.image && React.createElement('img', {
              src: article.image,
              alt: article.title,
              className: 'w-16 h-16 object-cover rounded'
            })
          );
        }

        return React.createElement('div', {
          className: `article-card bg-white rounded-lg overflow-hidden cursor-pointer ${sizeClasses[size]}`,
          onClick
        },
          article.image && React.createElement('div', { className: 'relative' },
            React.createElement('img', {
              src: article.image,
              alt: article.title,
              className: `w-full object-cover ${size === 'large' || size === 'featured' ? 'h-80' : 'h-48'}`
            }),
            article.imageCredit && React.createElement('p', {
              className: 'absolute bottom-2 left-2 text-xs text-white bg-black/50 px-2 py-1 rounded'
            }, article.imageCredit)
          ),
          React.createElement('div', { className: 'p-4' },
            article.category && React.createElement('p', { className: 'category-label text-red-600 font-semibold mb-2' }, article.category),
            React.createElement('h3', {
              className: `font-bold text-gray-900 mb-2 leading-tight ${size === 'large' || size === 'featured' ? 'text-2xl' : 'text-lg'}`
            }, article.title),
            article.subtitle && React.createElement('p', { className: 'text-gray-600 text-sm mb-3 line-clamp-2' }, article.subtitle),
            React.createElement('p', { className: 'text-xs text-gray-500 uppercase tracking-wide' }, article.byline)
          )
        );
      };

      // Homepage Component
      const Homepage = ({ articles, onSelectArticle, onNewArticle }) => {
        const featuredArticle = articles.find(a => a.featured) || articles[0];
        const sideArticles = articles.filter(a => !a.featured).slice(0, 2);
        const trendingArticles = articles.slice(0, 5);
        const gridArticles = articles.filter(a => !a.featured).slice(2, 6);

        return React.createElement('div', { className: 'min-h-screen bg-white' },
          // Header
          React.createElement('header', { className: 'border-b border-gray-200' },
            React.createElement('div', { className: 'max-w-7xl mx-auto px-4' },
              // Top nav
              React.createElement('div', { className: 'flex items-center justify-between py-3 border-b border-gray-100' },
                React.createElement('div', { className: 'flex items-center gap-6' },
                  React.createElement('button', { className: 'p-2 hover:bg-gray-100 rounded' },
                    React.createElement(Icon, { name: 'menu', size: 20 })
                  ),
                  React.createElement('button', { className: 'p-2 hover:bg-gray-100 rounded' },
                    React.createElement(Icon, { name: 'search', size: 20 })
                  ),
                  React.createElement('nav', { className: 'hidden md:flex items-center gap-4 text-sm' },
                    React.createElement('a', { href: '#', className: 'text-gray-700 hover:text-gray-900' }, 'Popular'),
                    React.createElement('a', { href: '#', className: 'text-gray-700 hover:text-gray-900' }, 'Latest'),
                    React.createElement('a', { href: '#', className: 'text-gray-700 hover:text-gray-900' }, 'Newsletters')
                  )
                ),
                React.createElement('div', { className: 'flex items-center gap-4' },
                  React.createElement('button', { className: 'text-sm text-gray-700 hover:text-gray-900' }, 'Sign In'),
                  React.createElement('button', {
                    onClick: onNewArticle,
                    className: 'px-4 py-2 bg-red-600 text-white text-sm font-medium rounded hover:bg-red-700 transition-colors'
                  }, 'New Article')
                )
              ),
              // Logo
              React.createElement('div', { className: 'py-6 text-center' },
                React.createElement('h1', { className: 'text-5xl font-serif font-bold italic text-gray-900' }, 'The Editor'),
                React.createElement('p', { className: 'text-sm text-gray-500 mt-1' }, 'Professional News Publishing Platform')
              )
            )
          ),
          // Promotional banner
          React.createElement('div', { className: 'bg-amber-50 border-y border-amber-200 py-3' },
            React.createElement('div', { className: 'max-w-7xl mx-auto px-4 text-center' },
              React.createElement('p', { className: 'text-sm text-amber-800' },
                'Give a year of ',
                React.createElement('span', { className: 'italic' }, 'The Editor'),
                ', and we\'ll include our signature tote for free.*'
              )
            )
          ),
          // Main content
          React.createElement('main', { className: 'max-w-7xl mx-auto px-4 py-8' },
            React.createElement('div', { className: 'grid grid-cols-12 gap-8' },
              // Left column - sidebar articles
              React.createElement('div', { className: 'col-span-12 md:col-span-3 space-y-6' },
                sideArticles.map(article =>
                  React.createElement('div', { key: article.id, className: 'cursor-pointer', onClick: () => onSelectArticle(article) },
                    article.image && React.createElement('img', {
                      src: article.image,
                      alt: article.title,
                      className: 'w-full h-48 object-cover rounded-lg mb-3'
                    }),
                    article.imageCredit && React.createElement('p', { className: 'text-xs text-gray-400 mb-2' }, article.imageCredit),
                    article.category && React.createElement('p', { className: 'category-label text-red-600 font-semibold mb-1' }, article.category),
                    React.createElement('h3', { className: 'font-bold text-gray-900 text-lg leading-tight mb-2 hover:text-blue-600' }, article.title),
                    React.createElement('p', { className: 'text-xs text-gray-500 uppercase tracking-wide' }, article.byline)
                  )
                )
              ),
              // Center column - featured article
              React.createElement('div', { className: 'col-span-12 md:col-span-6' },
                featuredArticle && React.createElement('div', {
                  className: 'cursor-pointer',
                  onClick: () => onSelectArticle(featuredArticle)
                },
                  featuredArticle.image && React.createElement('div', { className: 'relative' },
                    React.createElement('img', {
                      src: featuredArticle.image,
                      alt: featuredArticle.title,
                      className: 'w-full h-96 object-cover rounded-lg'
                    }),
                    featuredArticle.imageCredit && React.createElement('p', {
                      className: 'text-xs text-gray-500 mt-2'
                    }, featuredArticle.imageCredit)
                  ),
                  React.createElement('div', { className: 'mt-4 text-center' },
                    React.createElement('h2', { className: 'font-serif text-3xl font-bold text-gray-900 leading-tight mb-3 hover:text-blue-600' },
                      featuredArticle.title
                    ),
                    featuredArticle.subtitle && React.createElement('p', { className: 'text-gray-600 text-lg mb-3' },
                      featuredArticle.subtitle
                    ),
                    React.createElement('p', { className: 'text-sm text-gray-500 uppercase tracking-wide' },
                      featuredArticle.byline
                    )
                  )
                )
              ),
              // Right column - trending
              React.createElement('div', { className: 'col-span-12 md:col-span-3' },
                React.createElement('h3', { className: 'font-semibold text-gray-900 mb-4 pb-2 border-b border-gray-200' }, 'Trending'),
                React.createElement('div', { className: 'space-y-0' },
                  trendingArticles.map(article =>
                    React.createElement(ArticleCard, {
                      key: article.id,
                      article,
                      size: 'list',
                      onClick: () => onSelectArticle(article)
                    })
                  )
                )
              )
            ),
            // Grid section
            React.createElement('div', { className: 'mt-12 pt-8 border-t border-gray-200' },
              React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-4 gap-6' },
                gridArticles.map(article =>
                  React.createElement(ArticleCard, {
                    key: article.id,
                    article,
                    size: 'medium',
                    onClick: () => onSelectArticle(article)
                  })
                )
              )
            )
          ),
          // Footer
          React.createElement('footer', { className: 'bg-gray-900 text-white py-12 mt-16' },
            React.createElement('div', { className: 'max-w-7xl mx-auto px-4 text-center' },
              React.createElement('h2', { className: 'text-2xl font-serif italic mb-4' }, 'The Editor'),
              React.createElement('p', { className: 'text-gray-400 text-sm' }, 'Professional news publishing inspired by NYT, WaPo & Guardian')
            )
          )
        );
      };

      const NewsArticleEditor = () => {
        const [currentView, setCurrentView] = useState('homepage'); // 'homepage' or 'editor'
        const [viewMode, setViewMode] = useState('wysiwyg');
        const [articles, setArticles] = useState(sampleArticles);
        const [showImageModal, setShowImageModal] = useState(false);
        const [content, setContent] = useState({
          title: 'Article Title',
          subtitle: '',
          byline: 'By Your Name',
          date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
          body: '<p>Start writing your investigative article here...</p>',
          featuredImage: null,
          metadata: {
            tags: [],
            categories: [],
            seo: {
              metaDescription: '',
              keywords: []
            }
          },
          headlines: [
            { text: 'Article Title', tested: false, clickRate: null }
          ],
          sources: [],
          documents: [],
          editorialNotes: [],
          status: 'draft'
        });

        const [showMetadata, setShowMetadata] = useState(false);
        const [showSources, setShowSources] = useState(false);
        const [showDocuments, setShowDocuments] = useState(false);
        const [showHistory, setShowHistory] = useState(false);
        const [history, setHistory] = useState([
          { timestamp: new Date(), user: 'You', action: 'Created article', snapshot: null }
        ]);

        const editorRef = useRef(null);
        const [currentHeadlineIndex, setCurrentHeadlineIndex] = useState(0);
        const isInitialMount = useRef(true);
        const [lastSaved, setLastSaved] = useState(null);
        const [wordCount, setWordCount] = useState(0);

        const getTextStats = (html) => {
          const text = html.replace(/<[^>]*>/g, '').trim();
          const words = text.split(/\s+/).filter(w => w.length > 0);
          return {
            words: words.length,
            characters: text.length,
            readingTime: Math.max(1, Math.ceil(words.length / 200))
          };
        };

        useEffect(() => {
          if (editorRef.current && isInitialMount.current && currentView === 'editor') {
            editorRef.current.innerHTML = content.body;
            isInitialMount.current = false;
            setWordCount(getTextStats(content.body).words);
          }
        }, [currentView]);

        useEffect(() => {
          const handleKeyDown = (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
              e.preventDefault();
              saveVersion('Manual save');
              setLastSaved(new Date());
            }
          };
          document.addEventListener('keydown', handleKeyDown);
          return () => document.removeEventListener('keydown', handleKeyDown);
        }, [content]);

        useEffect(() => {
          const autoSave = setInterval(() => {
            if (currentView === 'editor') {
              saveVersion('Auto-saved');
            }
          }, 60000);
          return () => clearInterval(autoSave);
        }, [content, currentView]);

        const saveVersion = (action) => {
          const newHistory = [
            {
              timestamp: new Date(),
              user: 'You',
              action: action,
              snapshot: JSON.parse(JSON.stringify(content))
            },
            ...history
          ];
          setHistory(newHistory.slice(0, 50));
        };

        const restoreVersion = (snapshot) => {
          if (window.confirm('Restore this version? Current changes will be saved to history.')) {
            saveVersion('Before restore');
            setContent(snapshot);
          }
        };

        const htmlToMarkdown = (html) => {
          let md = html
            .replace(/<h1>(.*?)<\/h1>/g, '# $1\n\n')
            .replace(/<h2>(.*?)<\/h2>/g, '## $1\n\n')
            .replace(/<h3>(.*?)<\/h3>/g, '### $1\n\n')
            .replace(/<h4>(.*?)<\/h4>/g, '#### $1\n\n')
            .replace(/<strong>(.*?)<\/strong>/g, '**$1**')
            .replace(/<b>(.*?)<\/b>/g, '**$1**')
            .replace(/<em>(.*?)<\/em>/g, '*$1*')
            .replace(/<i>(.*?)<\/i>/g, '*$1*')
            .replace(/<code>(.*?)<\/code>/g, '`$1`')
            .replace(/<a href="(.*?)">(.*?)<\/a>/g, '[$2]($1)')
            .replace(/<figure[^>]*>.*?<img src="(.*?)"[^>]*alt="(.*?)"[^>]*>.*?<figcaption>(.*?)<\/figcaption>.*?<\/figure>/gs, '![$2]($1)\n*$3*\n\n')
            .replace(/<img src="(.*?)".*?alt="(.*?)".*?>/g, '![$2]($1)')
            .replace(/<ul>/g, '\n')
            .replace(/<\/ul>/g, '\n')
            .replace(/<ol>/g, '\n')
            .replace(/<\/ol>/g, '\n')
            .replace(/<li>(.*?)<\/li>/g, '- $1\n')
            .replace(/<blockquote>(.*?)<\/blockquote>/g, '> $1\n\n')
            .replace(/<p>(.*?)<\/p>/g, '$1\n\n')
            .replace(/<br\s*\/?>/g, '\n')
            .replace(/<hr\s*\/?>/g, '\n---\n\n')
            .replace(/<[^>]*>/g, '');
          return md.trim();
        };

        const markdownToHtml = (md) => {
          let html = md
            .replace(/^#### (.*$)/gim, '<h4>$1</h4>')
            .replace(/^### (.*$)/gim, '<h3>$1</h3>')
            .replace(/^## (.*$)/gim, '<h2>$1</h2>')
            .replace(/^# (.*$)/gim, '<h1>$1</h1>')
            .replace(/\*\*\*(.*?)\*\*\*/g, '<strong><em>$1</em></strong>')
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/`(.*?)`/g, '<code>$1</code>')
            .replace(/!\[(.*?)\]\((.*?)\)/g, '<img src="$2" alt="$1" />')
            .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>')
            .replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>')
            .replace(/^---$/gim, '<hr />')
            .replace(/^- (.*$)/gim, '<li>$1</li>')
            .replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>')
            .replace(/\n\n/g, '</p><p>')
            .replace(/^(?!<[h|u|o|b])/gim, '<p>')
            .replace(/(<p>.*?)$/s, '$1</p>');
          return html;
        };

        const getFullDocument = (format) => {
          const bodyContent = format === 'markdown' ? htmlToMarkdown(content.body) : content.body;
          if (format === 'markdown') {
            let md = `# ${content.title}\n\n`;
            if (content.subtitle) md += `## ${content.subtitle}\n\n`;
            md += `${content.byline}\n\n${content.date}\n\n`;
            if (content.metadata.tags.length > 0) {
              md += `**Tags:** ${content.metadata.tags.join(', ')}\n\n`;
            }
            md += `---\n\n${bodyContent}`;
            if (content.sources.length > 0) {
              md += `\n\n---\n\n## Sources\n\n`;
              content.sources.forEach((source, i) => {
                md += `${i + 1}. **${source.name}** - ${source.type}\n`;
                if (source.url) md += `   ${source.url}\n`;
                if (source.notes) md += `   *${source.notes}*\n`;
                md += '\n';
              });
            }
            return md;
          } else if (format === 'html') {
            return `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${content.title}</title>
  <style>
    body { font-family: Georgia, serif; max-width: 800px; margin: 0 auto; padding: 40px 20px; line-height: 1.8; color: #1a1a1a; }
    h1 { font-size: 2.5em; margin-bottom: 0.2em; line-height: 1.2; }
    .subtitle { font-size: 1.5em; color: #666; font-weight: 400; margin-top: 0; }
    .byline { font-style: italic; margin: 1em 0 0.5em; }
    .date { color: #666; margin-bottom: 2em; }
    p { margin: 1.2em 0; font-size: 1.1em; }
    blockquote { border-left: 4px solid #0066cc; margin: 1.5em 0; padding-left: 1.5em; color: #444; font-style: italic; }
    figure { margin: 2em 0; }
    figure img { width: 100%; height: auto; }
    figcaption { color: #666; font-size: 0.9em; margin-top: 0.5em; font-style: italic; }
  </style>
</head>
<body>
  <article>
    <h1>${content.title}</h1>
    ${content.subtitle ? `<h2 class="subtitle">${content.subtitle}</h2>` : ''}
    <p class="byline">${content.byline}</p>
    <p class="date">${content.date}</p>
    <hr>
    ${content.body}
  </article>
</body>
</html>`;
          }
          return bodyContent;
        };

        const execCommand = (command, value = null) => {
          document.execCommand(command, false, value);
          if (editorRef.current) {
            setContent({ ...content, body: editorRef.current.innerHTML });
          }
        };

        const handleBodyChange = () => {
          if (editorRef.current) {
            const html = editorRef.current.innerHTML;
            setContent(prev => ({ ...prev, body: html }));
            setWordCount(getTextStats(html).words);
          }
        };

        const insertLink = () => {
          const url = prompt('Enter URL:');
          if (url) execCommand('createLink', url);
        };

        const insertImage = (imageData) => {
          let html = '';
          const alignClass = imageData.alignment === 'center' ? 'margin-left: auto; margin-right: auto;' :
                            imageData.alignment === 'right' ? 'margin-left: auto;' : '';
          const sizeStyle = imageData.size === 'full-width' ? 'width: 100%;' :
                           imageData.size === 'medium' ? 'width: 75%;' :
                           imageData.size === 'small' ? 'width: 50%;' :
                           imageData.size === 'float-left' ? 'float: left; width: 40%; margin-right: 1.5em; margin-bottom: 1em;' :
                           imageData.size === 'float-right' ? 'float: right; width: 40%; margin-left: 1.5em; margin-bottom: 1em;' : '';

          if (imageData.caption || imageData.credit) {
            html = `<figure style="${sizeStyle} ${alignClass}">
              <img src="${imageData.url}" alt="${imageData.caption || 'Image'}" style="width: 100%; height: auto; border-radius: 4px;" />
              <figcaption style="color: #666; font-size: 0.875rem; margin-top: 0.5em; font-style: italic;">
                ${imageData.caption || ''}${imageData.caption && imageData.credit ? ' ' : ''}${imageData.credit ? `<span style="color: #999;">${imageData.credit}</span>` : ''}
              </figcaption>
            </figure>`;
          } else {
            html = `<img src="${imageData.url}" alt="Image" style="${sizeStyle} ${alignClass} max-width: 100%; height: auto; border-radius: 4px; margin: 1em 0;" />`;
          }

          document.execCommand('insertHTML', false, html);
          handleBodyChange();
        };

        const handleSelectArticle = (article) => {
          setContent({
            ...content,
            title: article.title,
            subtitle: article.subtitle || '',
            byline: article.byline,
            date: article.date,
            body: article.body,
            featuredImage: article.image ? { url: article.image, credit: article.imageCredit } : null,
            metadata: {
              ...content.metadata,
              categories: article.category ? [article.category] : []
            }
          });
          isInitialMount.current = true;
          setCurrentView('editor');
        };

        const handleNewArticle = () => {
          setContent({
            title: 'Article Title',
            subtitle: '',
            byline: 'By Your Name',
            date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }),
            body: '<p>Start writing your investigative article here...</p>',
            featuredImage: null,
            metadata: { tags: [], categories: [], seo: { metaDescription: '', keywords: [] } },
            headlines: [{ text: 'Article Title', tested: false, clickRate: null }],
            sources: [],
            documents: [],
            editorialNotes: [],
            status: 'draft'
          });
          isInitialMount.current = true;
          setCurrentView('editor');
        };

        const addSource = () => {
          const name = prompt('Source name:');
          if (name) {
            const type = prompt('Source type:');
            const url = prompt('URL (optional):');
            const notes = prompt('Notes:');
            setContent({
              ...content,
              sources: [...content.sources, { name, type: type || 'Document', url, notes, dateAdded: new Date() }]
            });
            saveVersion('Added source');
          }
        };

        const addTag = () => {
          const tag = prompt('Enter tag:');
          if (tag && !content.metadata.tags.includes(tag)) {
            setContent({
              ...content,
              metadata: { ...content.metadata, tags: [...content.metadata.tags, tag] }
            });
          }
        };

        const addHeadlineVariant = () => {
          const variant = prompt('Enter headline variant:');
          if (variant) {
            setContent({
              ...content,
              headlines: [...content.headlines, { text: variant, tested: false, clickRate: null }]
            });
          }
        };

        const ToolbarButton = ({ icon, label, onClick }) => (
          React.createElement('button', {
            onClick,
            className: 'p-2 rounded hover:bg-gray-200 transition-colors',
            title: label,
            type: 'button'
          }, React.createElement(Icon, { name: icon, size: 18 }))
        );

        const StatusBadge = () => {
          const statusColors = {
            draft: 'bg-gray-200 text-gray-700',
            'in-review': 'bg-yellow-200 text-yellow-800',
            ready: 'bg-green-200 text-green-800',
            published: 'bg-blue-200 text-blue-800'
          };
          return React.createElement('span', {
            className: `px-3 py-1 rounded-full text-sm font-medium ${statusColors[content.status]}`
          }, content.status.charAt(0).toUpperCase() + content.status.slice(1));
        };

        // Show homepage
        if (currentView === 'homepage') {
          return React.createElement(Homepage, {
            articles,
            onSelectArticle: handleSelectArticle,
            onNewArticle: handleNewArticle
          });
        }

        // Show editor
        return React.createElement('div', { className: 'min-h-screen bg-gray-50' },
          // Image Modal
          React.createElement(ImageModal, {
            isOpen: showImageModal,
            onClose: () => setShowImageModal(false),
            onInsert: insertImage
          }),
          // Top Navigation
          React.createElement('div', { className: 'bg-white border-b border-gray-200 sticky top-0 z-40' },
            React.createElement('div', { className: 'max-w-7xl mx-auto px-4 py-3' },
              React.createElement('div', { className: 'flex items-center justify-between' },
                React.createElement('div', { className: 'flex items-center gap-4' },
                  React.createElement('button', {
                    onClick: () => setCurrentView('homepage'),
                    className: 'flex items-center gap-2 text-gray-600 hover:text-gray-900'
                  }, React.createElement(Icon, { name: 'arrow-left', size: 20 }), 'Back'),
                  React.createElement('div', { className: 'h-6 w-px bg-gray-300' }),
                  React.createElement('div', null,
                    React.createElement('h1', { className: 'text-xl font-bold text-gray-800' }, 'News Article Editor'),
                    React.createElement('p', { className: 'text-xs text-gray-500' }, 'Professional publishing inspired by NYT, WaPo & Guardian')
                  ),
                  React.createElement(StatusBadge)
                ),
                React.createElement('div', { className: 'flex items-center gap-3' },
                  React.createElement('div', { className: 'flex gap-1 bg-gray-100 rounded p-1' },
                    ['wysiwyg', 'markdown', 'html'].map(mode =>
                      React.createElement('button', {
                        key: mode,
                        onClick: () => setViewMode(mode),
                        className: `flex items-center gap-1 px-3 py-1.5 rounded text-sm transition-colors ${viewMode === mode ? 'bg-white text-gray-900 shadow-sm' : 'text-gray-600 hover:text-gray-900'}`
                      },
                        React.createElement(Icon, { name: mode === 'wysiwyg' ? 'eye' : mode === 'markdown' ? 'file-text' : 'code', size: 16 }),
                        mode === 'wysiwyg' ? 'Editor' : mode.charAt(0).toUpperCase() + mode.slice(1)
                      )
                    )
                  ),
                  React.createElement('button', {
                    onClick: () => { saveVersion('Manual save'); setLastSaved(new Date()); },
                    className: 'flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors'
                  }, React.createElement(Icon, { name: 'save', size: 16 }), 'Save'),
                  React.createElement('button', {
                    onClick: () => setShowHistory(!showHistory),
                    className: 'p-2 text-gray-600 hover:bg-gray-100 rounded transition-colors',
                    title: 'Version History'
                  }, React.createElement(Icon, { name: 'history', size: 20 }))
                )
              )
            )
          ),

          // Main content
          React.createElement('div', { className: 'max-w-7xl mx-auto p-6' },
            React.createElement('div', { className: 'grid grid-cols-12 gap-6' },
              // Editor area
              React.createElement('div', { className: showHistory ? 'col-span-8' : 'col-span-12' },
                viewMode === 'wysiwyg' && React.createElement('div', { className: 'bg-white rounded-lg shadow-sm' },
                  // Toolbar
                  React.createElement('div', { className: 'border-b border-gray-200 p-3 flex flex-wrap gap-1' },
                    React.createElement(ToolbarButton, { icon: 'bold', label: 'Bold', onClick: () => execCommand('bold') }),
                    React.createElement(ToolbarButton, { icon: 'italic', label: 'Italic', onClick: () => execCommand('italic') }),
                    React.createElement('div', { className: 'w-px bg-gray-300 mx-1' }),
                    React.createElement(ToolbarButton, { icon: 'heading-1', label: 'Heading 1', onClick: () => execCommand('formatBlock', '<h1>') }),
                    React.createElement(ToolbarButton, { icon: 'heading-2', label: 'Heading 2', onClick: () => execCommand('formatBlock', '<h2>') }),
                    React.createElement(ToolbarButton, { icon: 'heading-3', label: 'Heading 3', onClick: () => execCommand('formatBlock', '<h3>') }),
                    React.createElement('div', { className: 'w-px bg-gray-300 mx-1' }),
                    React.createElement(ToolbarButton, { icon: 'list', label: 'Bullet List', onClick: () => execCommand('insertUnorderedList') }),
                    React.createElement(ToolbarButton, { icon: 'list-ordered', label: 'Numbered List', onClick: () => execCommand('insertOrderedList') }),
                    React.createElement('div', { className: 'w-px bg-gray-300 mx-1' }),
                    React.createElement(ToolbarButton, { icon: 'quote', label: 'Quote', onClick: () => execCommand('formatBlock', '<blockquote>') }),
                    React.createElement(ToolbarButton, { icon: 'link', label: 'Insert Link', onClick: insertLink }),
                    React.createElement('button', {
                      onClick: () => setShowImageModal(true),
                      className: 'flex items-center gap-1 px-3 py-2 rounded bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors',
                      title: 'Insert Image'
                    }, React.createElement(Icon, { name: 'image', size: 18 }), React.createElement('span', { className: 'text-sm' }, 'Image')),
                    React.createElement('div', { className: 'w-px bg-gray-300 mx-1' }),
                    React.createElement(ToolbarButton, { icon: 'align-left', label: 'Align Left', onClick: () => execCommand('justifyLeft') }),
                    React.createElement(ToolbarButton, { icon: 'align-center', label: 'Align Center', onClick: () => execCommand('justifyCenter') }),
                    React.createElement(ToolbarButton, { icon: 'align-right', label: 'Align Right', onClick: () => execCommand('justifyRight') })
                  ),
                  // Featured Image
                  content.featuredImage && React.createElement('div', { className: 'relative' },
                    React.createElement('img', {
                      src: content.featuredImage.url,
                      alt: content.title,
                      className: 'w-full h-80 object-cover'
                    }),
                    content.featuredImage.credit && React.createElement('p', {
                      className: 'absolute bottom-2 left-4 text-xs text-white bg-black/50 px-2 py-1 rounded'
                    }, content.featuredImage.credit),
                    React.createElement('button', {
                      onClick: () => setContent({ ...content, featuredImage: null }),
                      className: 'absolute top-2 right-2 p-2 bg-white/90 rounded-full hover:bg-white text-gray-600'
                    }, React.createElement(Icon, { name: 'x', size: 16 }))
                  ),
                  // Add featured image button
                  !content.featuredImage && React.createElement('div', {
                    className: 'border-b border-gray-200 p-4 bg-gray-50'
                  },
                    React.createElement('button', {
                      onClick: () => {
                        const url = prompt('Enter featured image URL:');
                        if (url) {
                          const credit = prompt('Photo credit (optional):');
                          setContent({ ...content, featuredImage: { url, credit } });
                        }
                      },
                      className: 'flex items-center gap-2 text-gray-500 hover:text-gray-700'
                    }, React.createElement(Icon, { name: 'image-plus', size: 20 }), 'Add Featured Image')
                  ),
                  // Article metadata
                  React.createElement('div', { className: 'p-8 border-b border-gray-200' },
                    React.createElement('div', { className: 'mb-4' },
                      React.createElement('div', { className: 'flex items-center gap-2 mb-2' },
                        React.createElement('label', { className: 'text-sm font-medium text-blue-700' }, 'Headlines'),
                        React.createElement('span', { className: 'text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded' }, 'A/B Testing'),
                        React.createElement('button', { onClick: addHeadlineVariant, className: 'text-blue-500 hover:text-blue-600' },
                          React.createElement(Icon, { name: 'plus-circle', size: 16 })
                        )
                      ),
                      content.headlines.map((headline, idx) =>
                        React.createElement('div', { key: idx, className: 'flex items-center gap-2 mb-1' },
                          React.createElement('input', {
                            type: 'radio',
                            name: 'headline',
                            checked: idx === currentHeadlineIndex,
                            onChange: () => {
                              setCurrentHeadlineIndex(idx);
                              setContent({ ...content, title: headline.text });
                            }
                          }),
                          React.createElement('input', {
                            type: 'text',
                            value: headline.text,
                            onChange: (e) => {
                              const newHeadlines = [...content.headlines];
                              newHeadlines[idx].text = e.target.value;
                              if (idx === currentHeadlineIndex) {
                                setContent({ ...content, title: e.target.value, headlines: newHeadlines });
                              } else {
                                setContent({ ...content, headlines: newHeadlines });
                              }
                            },
                            className: 'flex-1 text-xl font-bold border-b border-gray-300 outline-none focus:border-blue-500'
                          })
                        )
                      )
                    ),
                    React.createElement('input', {
                      type: 'text',
                      value: content.subtitle,
                      onChange: (e) => setContent({ ...content, subtitle: e.target.value }),
                      className: 'w-full text-xl text-gray-600 mb-4 border-none outline-none',
                      placeholder: 'Subtitle (optional)'
                    }),
                    React.createElement('div', { className: 'flex gap-4 mb-3' },
                      React.createElement('input', {
                        type: 'text',
                        value: content.byline,
                        onChange: (e) => setContent({ ...content, byline: e.target.value }),
                        className: 'flex-1 italic text-gray-700 border-none outline-none',
                        placeholder: 'By Author Name'
                      }),
                      React.createElement('input', {
                        type: 'text',
                        value: content.date,
                        onChange: (e) => setContent({ ...content, date: e.target.value }),
                        className: 'text-gray-500 border-none outline-none'
                      })
                    ),
                    React.createElement('div', { className: 'flex gap-2 flex-wrap' },
                      React.createElement('button', {
                        onClick: addTag,
                        className: 'flex items-center gap-1 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded'
                      }, React.createElement(Icon, { name: 'tag', size: 14 }), 'Add Tag'),
                      React.createElement('button', {
                        onClick: addSource,
                        className: 'flex items-center gap-1 px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded'
                      }, React.createElement(Icon, { name: 'users', size: 14 }), `Sources (${content.sources.length})`)
                    ),
                    content.metadata.tags.length > 0 && React.createElement('div', { className: 'mt-3 flex flex-wrap gap-2' },
                      content.metadata.tags.map((tag, idx) =>
                        React.createElement('span', { key: idx, className: 'px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm flex items-center gap-1' },
                          tag,
                          React.createElement('button', {
                            onClick: () => setContent({
                              ...content,
                              metadata: { ...content.metadata, tags: content.metadata.tags.filter((_, i) => i !== idx) }
                            }),
                            className: 'hover:text-blue-900'
                          }, React.createElement(Icon, { name: 'x', size: 12 }))
                        )
                      )
                    )
                  ),
                  // Editor content
                  React.createElement('div', {
                    ref: editorRef,
                    contentEditable: true,
                    onInput: handleBodyChange,
                    onBlur: handleBodyChange,
                    className: 'p-8 min-h-[500px] prose max-w-none focus:outline-none',
                    style: { fontFamily: 'Georgia, serif', fontSize: '18px', lineHeight: '1.8' },
                    suppressContentEditableWarning: true
                  })
                ),

                // Markdown view
                viewMode === 'markdown' && React.createElement('div', { className: 'bg-white rounded-lg shadow-sm p-8' },
                  React.createElement('textarea', {
                    value: getFullDocument('markdown'),
                    onChange: (e) => {
                      const bodyMatch = e.target.value.match(/---\n\n([\s\S]*?)(?:\n\n---\n\n## Sources|$)/);
                      if (bodyMatch) {
                        setContent({ ...content, body: markdownToHtml(bodyMatch[1].trim()) });
                      }
                    },
                    className: 'w-full h-[700px] font-mono text-sm p-4 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500',
                    spellCheck: false
                  })
                ),

                // HTML view
                viewMode === 'html' && React.createElement('div', { className: 'bg-white rounded-lg shadow-sm p-8' },
                  React.createElement('textarea', {
                    value: getFullDocument('html'),
                    readOnly: true,
                    className: 'w-full h-[700px] font-mono text-sm p-4 border border-gray-300 rounded bg-gray-50',
                    spellCheck: false
                  })
                )
              ),

              // History panel
              showHistory && React.createElement('div', { className: 'col-span-4' },
                React.createElement('div', { className: 'bg-white rounded-lg shadow-sm p-4' },
                  React.createElement('div', { className: 'flex items-center justify-between mb-4' },
                    React.createElement('h3', { className: 'font-semibold text-gray-800' }, 'Version History'),
                    React.createElement('button', { onClick: () => setShowHistory(false), className: 'text-gray-400 hover:text-gray-600' }, 'Ã—')
                  ),
                  React.createElement('div', { className: 'space-y-2 max-h-96 overflow-y-auto' },
                    history.map((item, idx) =>
                      React.createElement('div', { key: idx, className: 'p-3 bg-gray-50 rounded border border-gray-200' },
                        React.createElement('p', { className: 'text-sm font-medium text-gray-900' }, item.action),
                        React.createElement('p', { className: 'text-xs text-gray-500' }, new Date(item.timestamp).toLocaleString()),
                        item.snapshot && React.createElement('button', {
                          onClick: () => restoreVersion(item.snapshot),
                          className: 'text-xs text-blue-600 hover:text-blue-700 mt-1'
                        }, 'Restore')
                      )
                    )
                  )
                )
              )
            ),

            // Export bar
            React.createElement('div', { className: 'mt-6 bg-white rounded-lg shadow-sm p-4' },
              React.createElement('div', { className: 'flex items-center justify-between' },
                React.createElement('div', null,
                  React.createElement('h3', { className: 'text-sm font-semibold text-gray-700 mb-2' }, 'Export Options'),
                  React.createElement('div', { className: 'flex gap-3' },
                    React.createElement('button', {
                      onClick: () => {
                        const blob = new Blob([getFullDocument('html')], { type: 'text/html' });
                        const a = document.createElement('a');
                        a.href = URL.createObjectURL(blob);
                        a.download = `${content.title.replace(/[^a-z0-9]/gi, '-').toLowerCase()}.html`;
                        a.click();
                      },
                      className: 'flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm'
                    }, React.createElement(Icon, { name: 'download', size: 16 }), 'HTML'),
                    React.createElement('button', {
                      onClick: () => {
                        const blob = new Blob([getFullDocument('markdown')], { type: 'text/markdown' });
                        const a = document.createElement('a');
                        a.href = URL.createObjectURL(blob);
                        a.download = `${content.title.replace(/[^a-z0-9]/gi, '-').toLowerCase()}.md`;
                        a.click();
                      },
                      className: 'flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 text-sm'
                    }, React.createElement(Icon, { name: 'download', size: 16 }), 'Markdown'),
                    React.createElement('button', {
                      onClick: () => navigator.clipboard.writeText(getFullDocument(viewMode === 'wysiwyg' ? 'html' : viewMode)),
                      className: 'flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm'
                    }, React.createElement(Icon, { name: 'copy', size: 16 }), 'Copy')
                  )
                ),
                React.createElement('div', { className: 'text-right' },
                  lastSaved && React.createElement('p', { className: 'text-xs text-green-600 mb-1' },
                    `Saved ${lastSaved.toLocaleTimeString()}`
                  ),
                  React.createElement('p', { className: 'text-xs text-gray-500' },
                    `${wordCount} words`,
                    React.createElement('span', { className: 'mx-2' }, '|'),
                    `${getTextStats(content.body).readingTime} min read`
                  )
                )
              )
            )
          )
        );
      };

      // Render the app
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(NewsArticleEditor));
    </script>
  </body>
</html>
